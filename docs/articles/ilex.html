<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Physcraper Examples: the Hollies • physcraperex</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Physcraper Examples: the Hollies">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">physcraperex</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ilex.html">Physcraper Examples: the Hollies</a>
    </li>
    <li>
      <a href="../articles/malvaceae.html">Physcraper Examples: the Malvaceae</a>
    </li>
    <li>
      <a href="../articles/schoch.html">Physcraper Examples: the Dothideomycetes</a>
    </li>
    <li>
      <a href="../articles/todo.html">TODO</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Physcraper Examples: the Hollies</h1>
            
      
      
      <div class="hidden name"><code>ilex.Rmd</code></div>

    </div>

    
    
<div class="figure">
<img src="images/holly-snow.jpg" alt="*Ilex* fruits and leaves in the snow. Image by [Wolfgang Claussen](https://pixabay.com/es/users/WolfBlur-2503887/) at [Pixabay](https://pixabay.com/es/photos/holly-ilex-aquifolium-la-nieve-3012084/)." width="75%"><p class="caption">
<em>Ilex</em> fruits and leaves in the snow. Image by <a href="https://pixabay.com/es/users/WolfBlur-2503887/">Wolfgang Claussen</a> at <a href="https://pixabay.com/es/photos/holly-ilex-aquifolium-la-nieve-3012084/">Pixabay</a>.
</p>
</div>
<div id="i--finding-a-tree-to-update" class="section level2">
<h2 class="hasAnchor">
<a href="#i--finding-a-tree-to-update" class="anchor"></a>I. Finding a tree to update</h2>
<div id="using-the-open-tree-of-life-website" class="section level3">
<h3 class="hasAnchor">
<a href="#using-the-open-tree-of-life-website" class="anchor"></a>Using the Open Tree of Life website</h3>
<p>Go to the <a href="https://tree.opentreeoflife.org/opentree/argus/opentree12.3@ott93302">Open Tree of Life website</a> and use the “search for taxon” menu to look up for the taxon <em>Ilex</em>.</p>
<p>The screenshpt below shows the state of the genus <em>Ilex</em> in the Open Tree of Life synthetic tree on May 25, 2020. If you go to OpenTree’s website you can check out <em>Ilex</em> current state <a href="https://tree.opentreeoflife.org/opentree/argus/ottol@727571/Ilex">here</a>.</p>
<div class="figure">
<img src="ilex-tree-opentree-2020-05-31.png" alt="Phylogenetic representation of the hollies in OpenTree's synthetic tree." width="100%"><p class="caption">
Phylogenetic representation of the hollies in OpenTree’s synthetic tree.
</p>
</div>
<hr>
<p>Navigating into the tree, we notice that there might be two studies associated to this portion of the Open Tree synthetic tree.</p>
<p><img src="ilex-tree-opentree-2020-05-31-2.png" width="100%"></p>
<hr>
<p>Let’s verify that on the <a href="https://tree.opentreeoflife.org/curator">study curator of OToL</a>.</p>
<p>Studies matching the word ‘ilex’ on the curator database, at the middle of year 2020. Some of these studies are not actually about the hollies, but other taxa that have the species epithet <em>ilex</em>, e.g., the holly oak <em>Quercus ilex</em> or the rodent <em>Apodemus ilex</em></p>
<p><img src="ilex-curation-opentree-2020-05-31.png" width="100%"></p>
</div>
<div id="using-the-r-package-rotl" class="section level3">
<h3 class="hasAnchor">
<a href="#using-the-r-package-rotl" class="anchor"></a>Using the R package rotl</h3>
<!-- ```{r} -->
<!-- ilex <- rotl::tnrs_match_names(names = "ilex") -->
<!-- ``` -->
<!-- ```{r, results='asis', echo=FALSE} -->
<!-- knitr::kable(ilex, caption = "Taxonomic Name Resolution information for the genus *Ilex*") -->
<!-- ``` -->
<!-- Can we use the *OTT id* to get some trees or studies? -->
<!-- ```{r} -->
<!-- rotl::studies_properties() -->
<!-- ``` -->
<p>Explain what a focal clade is.</p>
<p>There is a handy function that will search a taxon among the focal clades reported across trees.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">studies &lt;-<span class="st"> </span>rotl<span class="op">::</span><span class="kw"><a href="https://docs.ropensci.org/rotl/reference/studies_find_studies.html">studies_find_studies</a></span>(<span class="dt">property=</span><span class="st">"ot:focalCladeOTTTaxonName"</span>, <span class="dt">value=</span><span class="st">"Ilex"</span>)</a></code></pre></div>
<table class="table">
<caption>Studies with the genus <em>Ilex</em> as focal clade.</caption>
<colgroup>
<col width="4%">
<col width="3%">
<col width="8%">
<col width="4%">
<col width="5%">
<col width="55%">
<col width="17%">
</colgroup>
<thead><tr class="header">
<th align="left">study_ids</th>
<th align="left">n_trees</th>
<th align="left">tree_ids</th>
<th align="left">candidate</th>
<th align="left">study_year</th>
<th align="left">title</th>
<th align="left">study_doi</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ot_1984</td>
<td align="left">1</td>
<td align="left">tree1</td>
<td align="left"></td>
<td align="left">2020</td>
<td align="left"></td>
<td align="left"><a href="http://dx.doi.org/10.1111/jse.12567" class="uri">http://dx.doi.org/10.1111/jse.12567</a></td>
</tr>
<tr class="even">
<td align="left">pg_2827</td>
<td align="left">2</td>
<td align="left">tree6576, tree6577</td>
<td align="left">tree6577</td>
<td align="left">2003</td>
<td align="left">Molecular analyses of the genus Ilex (Aquifoliaceae) in southern South America, evidence from AFLP and ITS sequence data</td>
<td align="left"><a href="http://dx.doi.org/10.3732/ajb.92.2.352" class="uri">http://dx.doi.org/10.3732/ajb.92.2.352</a></td>
</tr>
</tbody>
</table>
<p>It seems like the oldest tree, <em>tree6577</em> from study <em>pg_2827</em>, is in the Open Tree of Life synthetic tree.</p>
<p>Let’s get it and plot it here:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">original_tree &lt;-<span class="st"> </span>rotl<span class="op">::</span><span class="kw"><a href="https://docs.ropensci.org/rotl/reference/get_study_tree.html">get_study_tree</a></span>(<span class="dt">study_id =</span> <span class="st">"pg_2827"</span>, <span class="dt">tree_id =</span> <span class="st">"tree6577"</span>)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co">#&gt; Warning in build_raw_phylo(ncl, missing_edge_length): missing edge lengths are</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#&gt; not allowed in phylo class. All removed.</span></a>
<a class="sourceLine" id="cb2-4" title="4">ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html">plot.phylo</a></span>(ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/ladderize.html">ladderize</a></span>(original_tree), <span class="dt">type =</span> <span class="st">"phylogram"</span>, <span class="dt">cex =</span> <span class="fl">0.3</span>, <span class="dt">label.offset =</span> <span class="dv">1</span>, <span class="dt">edge.width =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="ilex_files/figure-html/original-tree-1.png" width="100%" style="background-color: #DCDCDC; padding:10px; display: inline-block;"></p>
<hr>
<p>Now, let’s look at some properties of the tree:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/summary.phylo.html">Ntip</a></span>(original_tree)  <span class="co"># gets the number of tips</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">#&gt; [1] 48</span></a>
<a class="sourceLine" id="cb3-3" title="3">ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/root.html">is.rooted</a></span>(original_tree)  <span class="co"># check that it is rooted</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb3-5" title="5">ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/is.binary.tree.html">is.binary</a></span>(original_tree)  <span class="co"># check that it is fully resolved</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb3-7" title="7">datelife<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/datelife/man/phylo_has_brlen.html">phylo_has_brlen</a></span>(original_tree)  <span class="co"># checks that it has branch lengths</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt; [1] FALSE</span></a></code></pre></div>
<p>The tree has 48 tips, is rooted, has no branch lengths and is not fully resolved, as you probably already noted. Also, labels correspond to the labels reported on the original study <a href="http://dx.doi.org/10.3732/ajb.92.2.352">here</a>. Other labels are available to use as tip labels. For example, you can plot the tree using the unified taxonomic names, or the taxonomic ids.</p>
</div>
<div id="finding-a-tree-in-the-open-tree-of-life-phylesystem-with-at-least-one-tip-label-belonging-to-the-group-of-interest-" class="section level3">
<h3 class="hasAnchor">
<a href="#finding-a-tree-in-the-open-tree-of-life-phylesystem-with-at-least-one-tip-label-belonging-to-the-group-of-interest-" class="anchor"></a>Finding a tree in the Open Tree of Life phylesystem with at least one tip label belonging to the group of interest.</h3>
<pre><code>find_trees.py --taxon_name  "Ilex"</code></pre>
<hr>
</div>
</div>
<div id="ii--getting-the-underlying-alignment" class="section level2">
<h2 class="hasAnchor">
<a href="#ii--getting-the-underlying-alignment" class="anchor"></a>II. Getting the underlying alignment</h2>
<div id="from-treebase" class="section level3">
<h3 class="hasAnchor">
<a href="#from-treebase" class="anchor"></a>From TreeBASE</h3>
<div id="using-physcraper-and-the-arguments--tb-and--no_est" class="section level4">
<h4 class="hasAnchor">
<a href="#using-physcraper-and-the-arguments--tb-and--no_est" class="anchor"></a>Using physcraper and the arguments <code>-tb</code> and <code>-no_est</code>
</h4>
<pre><code>physcraper_run.py -s pg_2827 -t tree6577 -tb -no_est -o data/pg_2827_tree6577</code></pre>
</div>
<div id="downloading-the-alignment-directly-from-a-repository" class="section level4">
<h4 class="hasAnchor">
<a href="#downloading-the-alignment-directly-from-a-repository" class="anchor"></a>Downloading the alignment directly from a repository</h4>
<p>The alignments are here <a href="https://treebase.org/treebase-web/search/study/matrices.html?id=1091" class="uri">https://treebase.org/treebase-web/search/study/matrices.html?id=1091</a></p>
<p>On a mac you can do:</p>
<pre><code>wget "http://purl.org/phylo/treebase/phylows/matrix/TB2:M2478?format=nexus" -o data-raw/alignments/T1281-M2478.nex</code></pre>
</div>
</div>
<div id="other-repos" class="section level3">
<h3 class="hasAnchor">
<a href="#other-repos" class="anchor"></a>Other repos</h3>
<hr>
</div>
</div>
<div id="iii--starting-a-physcraper-a-run" class="section level2">
<h2 class="hasAnchor">
<a href="#iii--starting-a-physcraper-a-run" class="anchor"></a>III. Starting a Physcraper a run</h2>
<pre><code>physcraper_run.py -s pg_2827 -t tree6577 -o data/pg_2827_tree6577</code></pre>
<pre><code>physcraper_run.py -s pg_2827 -t tree6577 -a data-raw/alignments/T1281-M2478.nex -as nexus -o data/ilex-remote</code></pre>
<div id="using-a-local-blast-database" class="section level3">
<h3 class="hasAnchor">
<a href="#using-a-local-blast-database" class="anchor"></a>Using a local BLAST database</h3>
<pre><code>physcraper_run.py -s pg_2827 -t tree6577 -a data-raw/alignments/T1281-M2478.nex -as nexus -db local_blast_db -o data/ilex-local</code></pre>
<hr>
</div>
</div>
<div id="iv--reading-the-physcraper-results" class="section level2">
<h2 class="hasAnchor">
<a href="#iv--reading-the-physcraper-results" class="anchor"></a>IV. Reading the Physcraper results</h2>
<div id="the-physcraper-tag" class="section level3">
<h3 class="hasAnchor">
<a href="#the-physcraper-tag" class="anchor"></a>The Physcraper tag</h3>
<p>T1281-M2478</p>
</div>
<div id="input-files" class="section level3">
<h3 class="hasAnchor">
<a href="#input-files" class="anchor"></a>Input files</h3>
<p>Physcraper rewrites input files for a couple reasons: reproducibility, taxon name matching, and taxon reconciliation. It writes the config file down if none was provided</p>
</div>
<div id="run-files" class="section level3">
<h3 class="hasAnchor">
<a href="#run-files" class="anchor"></a>Run files</h3>
<p>Files in here are also automatically written down by physcraper.</p>
<p>blast runs, alignments, raxml trees, bootstrap</p>
<p>The trees are reconstructed using RAxML, with tip labels corresponding to local ids (e.g., otu42009, otuPS1) and not taxon names (e.g., <em>Helwingia japonica</em>), nor taxonomic ids (e.g., ott or ncbi). Branch lengths are proportional to relative substitution rates. The RAxML tree with taxon names as tip labels is saved on the <code>outputs_tag</code> folder.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">updated_tree_otus &lt;-<span class="st"> </span>ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/read.tree.html">read.tree</a></span>(<span class="dt">file =</span> <span class="st">"../data/ilex-local/run_T1281-M2478/RAxML_bestTree.2020-06-29"</span>)</a>
<a class="sourceLine" id="cb10-2" title="2">ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html">plot.phylo</a></span>(ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/ladderize.html">ladderize</a></span>(updated_tree_otus), <span class="dt">type =</span> <span class="st">"fan"</span>, <span class="dt">cex =</span> <span class="fl">0.25</span>, <span class="dt">label.offset =</span> <span class="fl">0.01</span>, <span class="dt">edge.width =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb10-3" title="3">ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/add.scale.bar.html">add.scale.bar</a></span>(<span class="dt">cex =</span> <span class="fl">0.3</span>, <span class="dt">font =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">"black"</span>)</a>
<a class="sourceLine" id="cb10-4" title="4"><span class="kw"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="st">"Updated tree - otu tags as labels"</span>, <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">-1</span>)</a></code></pre></div>
<p><img src="ilex_files/figure-html/updated-tree-otus-1.png" width="100%" style="background-color: #6B8E23; padding:10px; display: inline-block;"></p>
</div>
<div id="output-files" class="section level3">
<h3 class="hasAnchor">
<a href="#output-files" class="anchor"></a>Output files</h3>
<p>A number of files is automatically written down by physcraper.</p>
<p>A nexson tree with all types of tip labels is saved in here. From this tree, a tree with any kind of label can be produced. By default, the updtaed tree with taxon names as tip labels is saved in the <code>output_tag</code> folder as <code>updated_taxonname.tre</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">updated_tree_taxonname &lt;-<span class="st"> </span>ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/read.tree.html">read.tree</a></span>(</a>
<a class="sourceLine" id="cb11-2" title="2">  <span class="dt">file =</span> <span class="st">"../data/ilex-local/outputs_T1281-M2478/updated_taxonname.tre"</span>)</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co"># ape::plot.phylo(ape::ladderize(updated_tree_taxonname), cex = 0.35)</span></a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html">plot.phylo</a></span>(ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/ladderize.html">ladderize</a></span>(updated_tree_taxonname), <span class="dt">type =</span> <span class="st">"fan"</span>, <span class="dt">cex =</span> <span class="fl">0.25</span>, <span class="dt">label.offset =</span> <span class="fl">0.01</span>, <span class="dt">edge.width =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb12-2" title="2">ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/add.scale.bar.html">add.scale.bar</a></span>(<span class="dt">cex =</span> <span class="fl">0.3</span>, <span class="dt">font =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">"black"</span>)</a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="st">"Updated tree - Taxon names as labels  "</span>, <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">-1</span>)</a></code></pre></div>
<p><img src="ilex_files/figure-html/updated-tree-taxonname-1.png" width="100%" style="background-color: #9ecff7; padding:10px; display: inline-block;"></p>
<hr>
</div>
</div>
<div id="v--visualizing-the-physcraper-results" class="section level2">
<h2 class="hasAnchor">
<a href="#v--visualizing-the-physcraper-results" class="anchor"></a>V. Visualizing the Physcraper results</h2>
<p>First, compare the original tree with the updated tree.</p>
<p>We can prune the updated tree, so it is a more straight forward comparison:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">original_tree_taxonname &lt;-<span class="st"> </span>ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/read.tree.html">read.tree</a></span>(<span class="dt">file =</span> <span class="st">"../data/ilex-local/inputs_T1281-M2478/taxonname.tre"</span>)</a>
<a class="sourceLine" id="cb13-2" title="2">tips2keep &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/match.html">match</a></span>(original_tree_taxonname<span class="op">$</span>tip.label,updated_tree_taxonname<span class="op">$</span>tip.label)</a>
<a class="sourceLine" id="cb13-3" title="3"></a>
<a class="sourceLine" id="cb13-4" title="4">pruned_updated_tree_taxonname &lt;-<span class="st"> </span>ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/drop.tip.html">drop.tip</a></span>(updated_tree_taxonname, updated_tree_taxonname<span class="op">$</span>tip.label[<span class="op">-</span>tips2keep])</a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">original_tree_taxonname<span class="op">$</span>edge.length &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb14-2" title="2">original_tree_taxonname2 &lt;-<span class="st"> </span>original_tree_taxonname</a>
<a class="sourceLine" id="cb14-3" title="3">original_tree_taxonname2<span class="op">$</span>tip.label &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="st">"_otu.*"</span>, <span class="st">""</span>, original_tree_taxonname<span class="op">$</span>tip.label)</a>
<a class="sourceLine" id="cb14-4" title="4"></a>
<a class="sourceLine" id="cb14-5" title="5">pruned_updated_tree_taxonname2 &lt;-<span class="st"> </span>pruned_updated_tree_taxonname</a>
<a class="sourceLine" id="cb14-6" title="6">pruned_updated_tree_taxonname2<span class="op">$</span>tip.label &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="st">"_otu.*"</span>, <span class="st">""</span>, pruned_updated_tree_taxonname<span class="op">$</span>tip.label)</a>
<a class="sourceLine" id="cb14-7" title="7"></a>
<a class="sourceLine" id="cb14-8" title="8">cotree1 &lt;-<span class="st"> </span>phytools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/phytools/man/cophylo.html">cophylo</a></span>(ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/ladderize.html">ladderize</a></span>(original_tree_taxonname2), ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/ladderize.html">ladderize</a></span>(pruned_updated_tree_taxonname2), <span class="dt">rotate.multi =</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p>Rotating nodes to optimize matching… Done.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"></a>
<a class="sourceLine" id="cb15-2" title="2">phytools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/phytools/man/cophylo.html">plot.cophylo</a></span>(</a>
<a class="sourceLine" id="cb15-3" title="3">  <span class="dt">x =</span> cotree1,</a>
<a class="sourceLine" id="cb15-4" title="4">  <span class="dt">fsize =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb15-5" title="5">  <span class="dt">lwd =</span> <span class="fl">0.4</span>,</a>
<a class="sourceLine" id="cb15-6" title="6">  <span class="dt">mar=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">1</span>,.<span class="dv">1</span>,<span class="dv">8</span>,.<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb15-7" title="7">  <span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span>.<span class="dv">1</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb15-8" title="8">  <span class="dt">scale.bar=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb15-9" title="9">  <span class="dt">link.lwd=</span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb15-10" title="10">  <span class="dt">link.lty=</span><span class="st">"solid"</span>,</a>
<a class="sourceLine" id="cb15-11" title="11">  <span class="dt">link.col=</span>phytools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/phytools/man/densityTree.html">make.transparent</a></span>(<span class="st">"#8B008B"</span>,<span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb15-12" title="12"><span class="kw"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw"><a href="https://rdrr.io/r/grDevices/plotmath.html">bold</a></span>(<span class="st">"Original tree"</span>)), <span class="dt">cex =</span> <span class="fl">4.5</span>, <span class="dt">side=</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">0</span>, <span class="dt">adj =</span> <span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb15-13" title="13"><span class="kw"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw"><a href="https://rdrr.io/r/grDevices/plotmath.html">bold</a></span>(<span class="st">"Pruned updated tree"</span>)), <span class="dt">cex =</span> <span class="fl">4.5</span>, <span class="dt">side=</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">0</span>, <span class="dt">adj =</span> <span class="fl">0.9</span>)</a></code></pre></div>
<p><img src="ilex_files/figure-html/cotree-plot1-1.png" width="90%" style="background-color: #8B008B; padding:10px; display: inline-block;"></p>
<p>But, comparing vs the whole updated tree is more interesting:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">updated_tree_taxonname2 &lt;-<span class="st"> </span>updated_tree_taxonname</a>
<a class="sourceLine" id="cb16-2" title="2">updated_tree_taxonname2<span class="op">$</span>tip.label &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="st">"_otu.*"</span>, <span class="st">""</span>, updated_tree_taxonname<span class="op">$</span>tip.label)</a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co"># updated_tree_taxonname2$edge.length &lt;- updated_tree_taxonname$edge.length*10 # for viz purposes! did not work</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co"># updated_tree_taxonname2$edge.length &lt;- NULL # does not work either</span></a>
<a class="sourceLine" id="cb16-5" title="5">cotree2 &lt;-<span class="st">  </span>phytools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/phytools/man/cophylo.html">cophylo</a></span>(</a>
<a class="sourceLine" id="cb16-6" title="6">  ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/ladderize.html">ladderize</a></span>(original_tree_taxonname2),</a>
<a class="sourceLine" id="cb16-7" title="7">  ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/ladderize.html">ladderize</a></span>(updated_tree_taxonname2)) <span class="co">#,</span></a></code></pre></div>
<p>Rotating nodes to optimize matching… Done.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">  <span class="co">#rotate.multi =TRUE) # it does not work with these trees for some reason.</span></a>
<a class="sourceLine" id="cb17-2" title="2">phytools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/phytools/man/cophylo.html">plot.cophylo</a></span>(</a>
<a class="sourceLine" id="cb17-3" title="3">  <span class="dt">x =</span> cotree2,</a>
<a class="sourceLine" id="cb17-4" title="4">  <span class="dt">fsize =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb17-5" title="5">  <span class="dt">lwd =</span> <span class="fl">0.4</span>,</a>
<a class="sourceLine" id="cb17-6" title="6">  <span class="dt">mar=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">1</span>,.<span class="dv">1</span>,<span class="dv">8</span>,.<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb17-7" title="7">  <span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span>.<span class="dv">1</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb17-8" title="8">  <span class="co"># xlim=c(-1,1),</span></a>
<a class="sourceLine" id="cb17-9" title="9">  <span class="dt">scale.bar=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb17-10" title="10">  <span class="co"># link.type="curved",</span></a>
<a class="sourceLine" id="cb17-11" title="11">  <span class="dt">link.lwd=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb17-12" title="12">  <span class="dt">link.lty=</span><span class="st">"solid"</span>,</a>
<a class="sourceLine" id="cb17-13" title="13">  <span class="dt">link.col=</span>phytools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/phytools/man/densityTree.html">make.transparent</a></span>(<span class="st">"#8B008B"</span>,<span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb17-14" title="14"><span class="kw"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw"><a href="https://rdrr.io/r/grDevices/plotmath.html">bold</a></span>(<span class="st">"Original tree"</span>)), <span class="dt">cex =</span> <span class="dv">4</span>, <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">0</span>, <span class="dt">adj =</span><span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb17-15" title="15"><span class="kw"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw"><a href="https://rdrr.io/r/grDevices/plotmath.html">bold</a></span>(<span class="st">"Updated tree"</span>)), <span class="dt">cex =</span> <span class="dv">4</span>, <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">0</span>, <span class="dt">adj =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<p><img src="ilex_files/figure-html/cotree-plot2-1.png" width="100%" style="background-color: #8B008B; padding:10px; display: inline-block;"></p>
<div id="now-compare-the-updated-tree-with-the-newer-tree" class="section level3">
<h3 class="hasAnchor">
<a href="#now-compare-the-updated-tree-with-the-newer-tree" class="anchor"></a>Now, compare the updated tree with the newer tree</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">newer_tree &lt;-<span class="st"> </span>rotl<span class="op">::</span><span class="kw"><a href="https://docs.ropensci.org/rotl/reference/get_study_tree.html">get_study_tree</a></span>(<span class="dt">study_id =</span> <span class="st">"ot_1984"</span>, <span class="dt">tree_id =</span> <span class="st">"tree1"</span>)</a>
<a class="sourceLine" id="cb18-2" title="2">ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html">plot.phylo</a></span>(ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/ladderize.html">ladderize</a></span>(newer_tree), <span class="dt">type =</span> <span class="st">"fan"</span>, <span class="dt">cex =</span> <span class="fl">0.3</span>, <span class="dt">label.offset =</span> <span class="fl">0.5</span>, <span class="dt">edge.width =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb18-3" title="3"><span class="kw"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="st">"Newer tree - matched labels"</span>, <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">cex =</span> <span class="fl">0.6</span>)</a></code></pre></div>
<p><img src="ilex_files/figure-html/newer-tree-1.png" width="100%" style="background-color: #FF1493; padding:10px; display: inline-block;"></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"></a>
<a class="sourceLine" id="cb19-2" title="2">cotree3 &lt;-<span class="st">  </span>phytools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/phytools/man/cophylo.html">cophylo</a></span>(</a>
<a class="sourceLine" id="cb19-3" title="3">  ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/ladderize.html">ladderize</a></span>(newer_tree),</a>
<a class="sourceLine" id="cb19-4" title="4">  ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/ladderize.html">ladderize</a></span>(updated_tree_taxonname2)) <span class="co">#,</span></a></code></pre></div>
<p>Rotating nodes to optimize matching… Done.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">  <span class="co">#rotate.multi =TRUE) # it does not work with these trees for some reason.</span></a>
<a class="sourceLine" id="cb20-2" title="2">phytools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/phytools/man/cophylo.html">plot.cophylo</a></span>(</a>
<a class="sourceLine" id="cb20-3" title="3">  <span class="dt">x =</span> cotree3,</a>
<a class="sourceLine" id="cb20-4" title="4">  <span class="dt">fsize =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb20-5" title="5">  <span class="dt">lwd =</span> <span class="fl">0.4</span>,</a>
<a class="sourceLine" id="cb20-6" title="6">  <span class="dt">mar=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">1</span>,.<span class="dv">1</span>,<span class="dv">8</span>,.<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb20-7" title="7">  <span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span>.<span class="dv">1</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb20-8" title="8">  <span class="co"># xlim=c(-1,1),</span></a>
<a class="sourceLine" id="cb20-9" title="9">  <span class="dt">scale.bar=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb20-10" title="10">  <span class="co"># link.type="curved",</span></a>
<a class="sourceLine" id="cb20-11" title="11">  <span class="dt">link.lwd=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb20-12" title="12">  <span class="dt">link.lty=</span><span class="st">"solid"</span>,</a>
<a class="sourceLine" id="cb20-13" title="13">  <span class="dt">link.col=</span>phytools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/phytools/man/densityTree.html">make.transparent</a></span>(<span class="st">"#FF1493"</span>,<span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb20-14" title="14"><span class="kw"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw"><a href="https://rdrr.io/r/grDevices/plotmath.html">bold</a></span>(<span class="st">"Newer tree"</span>)), <span class="dt">cex =</span> <span class="dv">4</span>, <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">0</span>, <span class="dt">adj =</span><span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb20-15" title="15"><span class="kw"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw"><a href="https://rdrr.io/r/grDevices/plotmath.html">bold</a></span>(<span class="st">"Updated old tree"</span>)), <span class="dt">cex =</span> <span class="dv">4</span>, <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">0</span>, <span class="dt">adj =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<p><img src="ilex_files/figure-html/cotree-plot3-1.png" width="100%" style="background-color: #FF1493; padding:10px; display: inline-block;"></p>
<pre class="r{plot_branches}"><code>treefile = 'data/pg_2827_tree6577/run_pg_2827tree6577_run4/RAxML_bestTree.2020-07-31'
otu_info_file = 'data/pg_2827_tree6577/outputs_pg_2827tree6577/otu_info_pg_2827tree6577.csv'
</code></pre>
<hr>
</div>
</div>
<div id="acknowledgments" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgments" class="anchor"></a>Acknowledgments</h2>
<p>Research was supported by the grant “Sustaining the Open Tree of Life”, National Science Foundation ABI No. 1759838, and ABI No. 1759846.</p>
<p>Computer time was provided by the Multi-Environment Research Computer for Exploration and Discovery (MERCED) cluster from the University of California, Merced (UCM), supported by the NSF Grant No. ACI-1429783.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#i--finding-a-tree-to-update">I. Finding a tree to update</a></li>
      <li><a href="#ii--getting-the-underlying-alignment">II. Getting the underlying alignment</a></li>
      <li><a href="#iii--starting-a-physcraper-a-run">III. Starting a Physcraper a run</a></li>
      <li><a href="#iv--reading-the-physcraper-results">IV. Reading the Physcraper results</a></li>
      <li><a href="#v--visualizing-the-physcraper-results">V. Visualizing the Physcraper results</a></li>
      <li><a href="#acknowledgments">Acknowledgments</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Luna L. Sanchez Reyes, Emily Jane McTavish.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
